{% extends "base.html" %}
{% load static %}
{% load extras %}

{% block title %}Trashed Notes - MindPad{% endblock %}

{% block content %}

<section class="text-center mb-10">
  <h2 class="text-3xl font-extrabold text-gray-800 dark:text-gray-100">
    🗑 Trashed Notes
  </h2>
  <p class="text-gray-600 dark:text-gray-400 mt-2">
    Manage and restore deleted notes, or permanently remove them.
  </p>
</section>

{% if notes %}
  <form method="post" action="{% url 'empty_trash' %}" class="mb-8 text-center">
    {% csrf_token %}
    <button type="submit" 
      onclick="return confirm('⚠️ Are you sure you want to empty the trash? This cannot be undone.')"
      class="px-5 py-2 bg-red-600 text-white rounded-lg shadow hover:bg-red-700 transition">
      🚮 Empty Trash
    </button>
  </form>

  <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
    {% for note in notes %}
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-5 hover:shadow-xl transition flex flex-col">
        <h4 class="text-lg font-bold text-indigo-600 dark:text-indigo-400 mb-2">
          {{ note.title }}
          {% if note.is_locked %} 🔒{% endif %}
        </h4>

        <p class="text-gray-700 dark:text-gray-300 flex-1">
          {{ note.body|truncatechars:100 }}
        </p>

        {% if note.tags.all %}
          <div class="mt-3 flex flex-wrap gap-2">
            {% for tag in note.tags.all %}
              <span class="bg-indigo-100 text-indigo-600 text-xs px-2 py-1 rounded-full">
                #{{ tag }}
              </span>
            {% endfor %}
          </div>
        {% endif %}

        <div class="mt-4 flex justify-between text-sm text-gray-500 dark:text-gray-400">
          <span>Deleted: {{ note.updated_at|short_timesince }}</span>
          <div class="flex gap-3">
            <form method="post" action="{% url 'note_restore' note.id %}">
              {% csrf_token %}
              <button type="submit" 
                onclick="return confirm('♻ Restore this note?')" 
                class="hover:text-green-600">♻ Restore</button>
            </form>
            <form method="post" action="{% url 'note_delete' note.id %}">
              {% csrf_token %}
              <button type="submit" 
                onclick="return confirm('❌ Permanently delete this note? This cannot be undone.')" 
                class="hover:text-red-600">❌ Delete</button>
            </form>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p class="text-gray-500 dark:text-gray-400 text-center">Trash is empty.</p>
{% endif %}

{% endblock %}
